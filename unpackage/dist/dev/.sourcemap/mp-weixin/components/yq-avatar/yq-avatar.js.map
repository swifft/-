{"version":3,"sources":["webpack:///E:/uniapp/ruanjiankaifashixun/components/yq-avatar/yq-avatar.vue?578a","webpack:///E:/uniapp/ruanjiankaifashixun/components/yq-avatar/yq-avatar.vue?50de","webpack:///E:/uniapp/ruanjiankaifashixun/components/yq-avatar/yq-avatar.vue?f98d","webpack:///E:/uniapp/ruanjiankaifashixun/components/yq-avatar/yq-avatar.vue?ebc3","uni-app:///components/yq-avatar/yq-avatar.vue","webpack:///E:/uniapp/ruanjiankaifashixun/components/yq-avatar/yq-avatar.vue?4e23","webpack:///E:/uniapp/ruanjiankaifashixun/components/yq-avatar/yq-avatar.vue?5515"],"names":[],"mappings":"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,SAvEA;AAwEA;AACA;AACA,2BADA;AAEA,0BAFA;;AAIA,SA7EA;AA8EA;AACA;AACA;AACA,SAjFA;AAkFA,UAlFA;;AAoFA,KA/RA;AAgSA,cAhSA,wBAgSA;AACA;AACA;AACA;AACA;AACA,OAFA,EAEA,IAFA;;AAIA;AACA,uCADA;AAEA,yCAFA;AAGA,sBAHA;AAIA,sBAJA;AAKA,8BALA;AAMA,gCANA;AAOA,iEAPA;AAQA,oEARA;;;;;;AAcA;AACA,uBADA;AAEA,kBAFA;;;;AAMA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkCA;AACA,eADA;AAEA,eAFA;AAGA,uBAHA;AAIA,yBAJA;AAKA,2BALA;AAMA,6BANA;AAOA,8BAPA;AAQA,4BARA;AASA,0BATA;AAUA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoDA;AACA,iCADA;AAEA,mBAFA;AAGA,8BAHA;AAIA,4BAJA;AAKA,yCALA;;;AAQA,SAvEA;AAwEA;AACA;AACA,8BADA;AAEA,0BAFA;;AAIA,SA7EA;AA8EA;AACA;AACA;AACA,SAjFA;AAkFA,UAlFA;;AAoFA,KApbA;AAqbA,aArbA,uBAqbA;AACA;AACA,mCADA;AAEA,8BAFA;AAGA,gCAHA;AAIA,qCAJA;AAKA,8BALA;AAMA,4CANA;AAOA,qCAPA;AAQA,8CARA;AASA,gDATA;;AAWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAtBA;;AAwBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAtBA;;AAwBA;AACA;AACA;AACA,OAHA,MAGA;AACA;AACA;AACA,OAHA,MAGA;AACA;AACA;AACA;AACA,SAHA,MAGA;AACA;AACA;AACA;AACA,OARA,MAQA;AACA;AACA;AACA;AACA,SAHA,MAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,iCADA;AAEA,+BAFA;AAGA,mCAHA;AAIA,qCAJA;AAKA,0BALA;AAMA,kCANA;AAOA,gCAPA;AAQA,wCARA;;AAUA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;;AAKA;;AAEA;AACA;AACA,OAXA;;AAaA;AACA,KAxlBA;AAylBA,cAzlBA,wBAylBA;AACA;AACA;AACA;;AAEA;AACA,+CADA;AAEA,iDAFA;;;;;;AAQA;;;;;AAKA;;AAEA,OAPA,MAOA;AACA;AACA;;AAEA;AACA;AACA,+CADA;;AAGA;AACA;AACA;;AAEA,OARA,MAQA;AACA;AACA;AACA;AACA;;AAEA;;;;;AAKA,KApoBA;AAqoBA,YAroBA,sBAqoBA;AACA;AACA;AACA;AACA;AACA,OAFA,EAEA,IAFA;;AAIA;AACA,8BADA;AAEA,6BAFA;AAGA,mCAHA;AAIA,qCAJA;;;;;;AAUA;AACA,uBADA;AAEA,kBAFA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6DA;AACA,YADA;AAEA,YAFA;AAGA,oBAHA;AAIA,sBAJA;AAKA,yCALA;AAMA,2CANA;AAOA,iCAPA;AAQA,4BARA;AASA,0BATA;AAUA;AACA;;AAEA;AACA,mCADA;AAEA,gDAFA;;;;;;;;;;;AAaA;AACA,sDADA;AAEA,8BAFA;AAGA,+BAHA;AAIA,qCAJA;AAKA,qCALA;AAMA;AACA;AACA;AACA,WAHA,MAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;AAUA;AACA;;;;;;;;;;;;;;;;;;;;AAoBA,SAhFA;AAiFA;AACA;AACA,2BADA;AAEA,0BAFA;;AAIA,SAtFA;AAuFA;AACA;AACA,SAzFA;AA0FA,UA1FA;;AA4FA,KA/yBA;AAgzBA,cAhzBA,wBAgzBA;AACA;AACA;AACA,oCADA;AAEA,kCAFA;AAGA,oCAHA;AAIA,gCAJA;AAKA,oCALA;AAMA,kCANA;AAOA,kCAPA;AAQA,kCARA;AASA,gCATA;AAUA,kCAVA;AAWA,4BAXA;AAYA,0BAZA;;AAcA;AACA,gBADA;AAEA;AACA,iBADA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAHA,MAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAl2BA;AAm2BA,WAn2BA,qBAm2BA;AACA;AACA;AACA,KAt2BA;AAu2BA,UAv2BA,kBAu2BA,CAv2BA,EAu2BA;AACA;AACA,yBADA;AAEA,yBAFA;;AAIA;AACA;;AAEA;AACA;AACA,+BADA;AAEA;AACA;AACA,KAp3BA;AAq3BA,SAr3BA,iBAq3BA,CAr3BA,EAq3BA;AACA;AACA,yBADA;AAEA,yBAFA;;AAIA;AACA;AACA,+BADA;AAEA,6CAFA;AAGA,0DAHA;AAIA,gDAJA;;AAMA;AACA;AACA;AACA;;AAEA;AACA,gDADA;AAEA;AACA;AACA,oDADA;AAEA,qCAFA;AAGA,sCAHA;AAIA,4BAJA;AAKA,6BALA;AAMA,+CANA;AAOA,6CAPA;AAQA,iDARA;AASA,mDATA;AAUA,gCAVA;AAWA,iCAXA;AAYA,uBAZA,CAYA,WAZA;;AAcA;AACA;AACA,kEADA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAhCA,MAgCA;AACA;AACA;AACA;;AAEA;AACA,SA7CA,QA6CA,CA7CA;AA8CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,OA/DA,MA+DA;AACA;AACA,qCADA;AAEA,gCAFA;AAGA,iCAHA;AAIA;AACA;AACA,sDADA;AAEA,kBAFA;AAGA,kBAHA;AAIA,6BAJA;AAKA,8BALA;AAMA,8CANA;AAOA,4CAPA;AAQA,wDARA;AASA,yDATA;AAUA,aAVA,CAUA,GAVA;;AAYA;AACA;;AAEA;AACA;AACA;AACA,aAFA,MAEA;AACA;AACA,aAFA,MAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAHA,MAGA;AACA;AACA;AACA,aAHA,MAGA;AACA;AACA;AACA;AACA;AACA,SAtCA,MAsCA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KA9+BA;AA++BA,QA/+BA,gBA++BA,CA/+BA,EA++BA;AACA;AACA,oCADA;AAEA,oCAFA;AAGA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA;AACA,KAz/BA;AA0/BA,YA1/BA,sBA0/BA;AACA;AACA;AACA;AACA;AACA;AACA,KAhgCA;AAigCA,UAjgCA,oBAigCA;AACA;AACA;AACA;AACA;AACA;AACA,KAvgCA;AAwgCA,eAxgCA,yBAwgCA;AACA;AACA;AACA,0BADA;AAEA,kCAFA;AAGA,oCAHA;;;;;;;;;;;;;;;;AAmBA;AACA,gCADA;AAEA,iBAFA;AAGA,iBAHA;AAIA,yBAJA;AAKA,2BALA;AAMA,iBANA,mBAMA,GANA,EAMA;AACA;AACA,WARA;AASA,cATA,gBASA,GATA,EASA;AACA;AACA,WAXA;AAYA,cAZA;;AAcA,OAlCA;AAmCA,KA5iCA;AA6iCA,gBA7iCA,wBA6iCA,CA7iCA,EA6iCA;AACA,sBADA,GACA,UADA;AAEA,2CAFA;AAGA;;;;;;AAMA;AACA,iCADA;AAEA,4BAFA,IATA;;;;AAeA,iCAfA;AAgBA;AACA;AACA,yCADA;AAEA,oCAFA;;AAIA,mBALA,CAhBA,aAgBA,iBAhBA;;AAuBA,gFAvBA;;;AA0BA,oBA1BA,GA0BA,iBA1BA;AA2BA,sBA3BA,GA2BA,aA3BA;AA4BA,iBA5BA,GA4BA,cA5BA;;;AA+BA;AACA;AACA,iBAFA,MAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAFA,MAEA;AACA;AACA,qBAFA,MAEA;AACA;AACA,qBAFA,MAEA;AACA;AACA,qBAFA,MAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAFA,MAEA;AACA;AACA,qBAFA,MAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,qBAFA,MAEA;AACA;AACA;;AAEA;AACA;AACA,qBAFA,MAEA;AACA;AACA;AACA,uBAFA,MAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAXA,GAWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAnBA;AAoBA,+BApBA,GAoBA;AACA;AACA;AACA,yBAFA,MAEA;AACA;AACA,yBAFA,MAEA;AACA;AACA;AACA;AACA,uBA7BA;AA8BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,oBAlHA,GAkHA,WAlHA;AAmHA,oBAnHA,GAmHA,WAnHA;AAoHA,wBApHA,GAoHA,eApHA;AAqHA,yBArHA,GAqHA,gBArHA;;;;;;;;;;;;;;;;;;;;;;AA2IA;AACA,wCADA;AAEA,yBAFA;AAGA,yBAHA;AAIA,iCAJA;AAKA,mCALA;AAMA,8BANA;AAOA,sBAPA,kBAOA;AACA;AACA,wCADA;AAEA,oCAFA;;AAIA,mBAZA;AAaA,0BAbA,sBAaA;AACA;AACA,mBAfA;AAgBA,sBAhBA,EA3IA;;AA6JA,KA1sCA;AA2sCA,QA3sCA,gBA2sCA,MA3sCA,EA2sCA;AACA;AACA;AACA;AACA,yCADA;AAEA,2BAFA;AAGA,uBAHA;AAIA,iCAJA;AAKA;AACA;AACA;AACA;AACA,oBADA;;AAGA,OAZA;AAaA,KA1tCA,EA/EA,E;;;;;;;;;;;;;AC/BA;AAAA;AAAA;AAAA;AAAq3B,CAAgB,s3BAAG,EAAC,C;;;;;;;;;;;ACAz4B;AACA,OAAO,KAAU,EAAE,kBAKd","file":"components/yq-avatar/yq-avatar.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./yq-avatar.vue?vue&type=template&id=795a15bc&name=yq-avatar&\"\nvar renderjs\nimport script from \"./yq-avatar.vue?vue&type=script&lang=js&\"\nexport * from \"./yq-avatar.vue?vue&type=script&lang=js&\"\nimport style0 from \"./yq-avatar.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/yq-avatar/yq-avatar.vue\"\nexport default component.exports","export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./yq-avatar.vue?vue&type=template&id=795a15bc&name=yq-avatar&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var s0 = _vm.__get_style([_vm.imgStyle])\n\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        s0: s0\n      }\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./yq-avatar.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./yq-avatar.vue?vue&type=script&lang=js&\"","<template name=\"yq-avatar\">\r\n\t<view>\r\n\t\t<image :src=\"imgSrc.imgSrc\" @click=\"fSelect\" :style=\"[ imgStyle ]\" class=\"my-avatar\"></image>\r\n\t\t<canvas canvas-id=\"avatar-canvas\" id=\"avatar-canvas\" class=\"my-canvas\" :style=\"{top: styleTop, height: cvsStyleHeight}\"\r\n\t\t disable-scroll=\"false\"></canvas>\r\n\t\t<canvas canvas-id=\"oper-canvas\" id=\"oper-canvas\" class=\"oper-canvas\" :style=\"{top: styleTop, height: cvsStyleHeight}\"\r\n\t\t disable-scroll=\"false\" @touchstart=\"fStart\" @touchmove=\"fMove\" @touchend=\"fEnd\"></canvas>\r\n\t\t<canvas canvas-id=\"prv-canvas\" id=\"prv-canvas\" class=\"prv-canvas\" disable-scroll=\"false\" @touchstart=\"fHideImg\"\r\n\t\t :style=\"{ height: cvsStyleHeight, top: prvTop }\"></canvas>\r\n\t\t<view class=\"oper-wrapper\" :style=\"{display: styleDisplay}\">\r\n\t\t\t<view class=\"oper\">\r\n\t\t\t\t<view class=\"btn-wrapper\" v-if=\"showOper\">\r\n\t\t\t\t\t<view @click=\"fSelect\" hover-class=\"hover\" :style=\"{width: btnWidth}\"><text>重选</text></view>\r\n\t\t\t\t\t<view @click=\"fClose\" hover-class=\"hover\" :style=\"{width: btnWidth}\"><text>关闭</text></view>\r\n\t\t\t\t\t<view @click=\"fRotate\" hover-class=\"hover\" :style=\"{width: btnWidth, display: btnDsp}\"><text>旋转</text></view>\r\n\t\t\t\t\t<view @click=\"fPreview\" hover-class=\"hover\" :style=\"{width: btnWidth}\"><text>预览</text></view>\r\n\t\t\t\t\t<view @click=\"fUpload\" hover-class=\"hover\" :style=\"{width: btnWidth}\"><text>上传</text></view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"clr-wrapper\" v-else>\r\n\t\t\t\t\t<slider class=\"my-slider\" @change=\"fColorChange\" block-size=\"25\" value=\"0\" min=\"-100\" max=\"100\" activeColor=\"red\"\r\n\t\t\t\t\t backgroundColor=\"green\" block-color=\"grey\" show-value></slider>\r\n\t\t\t\t\t<view @click=\"fPrvUpload\" hover-class=\"hover\" :style=\"{width: btnWidth}\"><text>上传</text></view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\t\"use strict\";\r\n\tconst tabHeight = 50;\r\n\texport default {\r\n\t\tname: \"yq-avatar\",\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tcvsStyleHeight: '0px',\r\n\t\t\t\tstyleDisplay: 'none',\r\n\t\t\t\tstyleTop: '-10000px',\r\n\t\t\t\tprvTop: '-10000px',\r\n\t\t\t\timgStyle: {},\r\n\t\t\t\tselStyle: {},\r\n\t\t\t\tshowOper: true,\r\n\t\t\t\timgSrc: {\r\n\t\t\t\t\timgSrc: ''\r\n\t\t\t\t},\r\n\t\t\t\tbtnWidth: '19%',\r\n\t\t\t\tbtnDsp: 'flex',\r\n\t\t\t};\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\tavatarSrc() {\r\n\t\t\t\tthis.imgSrc.imgSrc = this.avatarSrc;\r\n\t\t\t}\r\n\t\t},\r\n\t\tprops: {\r\n\t\t\tavatarSrc: '',\r\n\t\t\tavatarStyle: '',\r\n\t\t\tselWidth: '',\r\n\t\t\tselHeight: '',\r\n\t\t\texpWidth: '',\r\n\t\t\texpHeight: '',\r\n\t\t\tminScale: '',\r\n\t\t\tmaxScale: '',\r\n\t\t\tcanScale: '',\r\n\t\t\tcanRotate: '',\r\n\t\t\tlockWidth: '',\r\n\t\t\tlockHeight: '',\r\n\t\t\tstretch: '',\r\n\t\t\tlock: '',\r\n\t\t\tfileType: '',\r\n\t\t\tnoTab: '',\r\n\t\t\tinner: '',\r\n\t\t\tquality: '',\r\n\t\t\tindex: '',\r\n\t\t\tbgImage: '',\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tthis.ctxCanvas = uni.createCanvasContext('avatar-canvas', this);\r\n\t\t\tthis.ctxCanvasOper = uni.createCanvasContext('oper-canvas', this);\r\n\t\t\tthis.ctxCanvasPrv = uni.createCanvasContext('prv-canvas', this);\r\n\t\t\tthis.qlty = parseInt(this.quality) || 0.9;\r\n\t\t\tthis.imgSrc.imgSrc = this.avatarSrc;\r\n\t\t\tthis.letRotate = (this.canRotate === 'false' || this.inner === true || this.inner === 'true') ? 0 : 1;\r\n\t\t\tthis.letScale = this.canScale === 'false' ? 0 : 1;\r\n\t\t\tthis.isin = (this.inner === true || this.inner === 'true') ? 1 : 0;\r\n\t\t\tthis.indx = this.index || undefined;\r\n\t\t\tthis.mnScale = this.minScale || 0.3;\r\n\t\t\tthis.mxScale = this.maxScale || 4;\r\n\t\t\tthis.noBar = (this.noTab === true || this.noTab === 'true') ? 1 : 0;\r\n\t\t\tthis.stc = this.stretch;\r\n\t\t\tthis.lck = this.lock;\r\n\t\t\tthis.fType = this.fileType === 'jpg' ? 'jpg' : 'png';\r\n\t\t\tif (this.isin) {\r\n\t\t\t\tthis.btnWidth = '24%';\r\n\t\t\t\tthis.btnDsp = 'none';\r\n\t\t\t} else {\r\n\t\t\t\tthis.btnWidth = '19%';\r\n\t\t\t\tthis.btnDsp = 'flex';\r\n\t\t\t}\r\n\r\n\t\t\tif (this.noBar) {\r\n\t\t\t\tthis.fWindowResize();\r\n\t\t\t} else {\r\n\t\t\t\tuni.showTabBar({\r\n\t\t\t\t\tcomplete: (res) => {\r\n\t\t\t\t\t\tthis.fWindowResize();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tfWindowResize() {\r\n\t\t\t\tlet sysInfo = uni.getSystemInfoSync();\r\n\t\t\t\tthis.platform = sysInfo.platform;\r\n\t\t\t\tthis.pixelRatio = sysInfo.pixelRatio;\r\n\t\t\t\tthis.windowWidth = sysInfo.windowWidth;\r\n\r\n\t\t\t\t// #ifdef H5\r\n\t\t\t\tthis.drawTop = sysInfo.windowTop;\r\n\t\t\t\tthis.windowHeight = sysInfo.windowHeight + sysInfo.windowBottom;\r\n\t\t\t\tthis.cvsStyleHeight = this.windowHeight - tabHeight + 'px';\r\n\t\t\t\t// #endif\r\n\r\n\t\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\tif (this.platform === 'android') {\r\n\t\t\t\t\tthis.windowHeight = sysInfo.screenHeight;\r\n\t\t\t\t\tthis.cvsStyleHeight = this.windowHeight - tabHeight + 'px';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.windowHeight = sysInfo.windowHeight + tabHeight;\r\n\t\t\t\t\tthis.cvsStyleHeight = this.windowHeight - tabHeight + 6 + 'px';\r\n\t\t\t\t}\r\n\t\t\t\t// #endif\r\n\r\n\t\t\t\t// #ifdef MP\r\n\t\t\t\t// #ifdef MP-ALIPAY\r\n\t\t\t\tthis.windowHeight = sysInfo.screenHeight - sysInfo.statusBarHeight - sysInfo.titleBarHeight;\r\n\t\t\t\tthis.cvsStyleHeight = this.windowHeight - tabHeight - 2 + 'px';\r\n\t\t\t\t// #endif\r\n\t\t\t\t// #ifndef MP-ALIPAY\r\n\t\t\t\tthis.windowHeight = sysInfo.windowHeight + tabHeight;\r\n\t\t\t\tthis.cvsStyleHeight = this.windowHeight - tabHeight - 2 + 'px';\r\n\t\t\t\t// #endif\r\n\t\t\t\t// #endif\r\n\r\n\t\t\t\tthis.pxRatio = this.windowWidth / 750;\r\n\r\n\t\t\t\tlet style = this.avatarStyle;\r\n\t\t\t\tif (style && style !== true && (style = style.trim())) {\r\n\t\t\t\t\tstyle = style.split(';');\r\n\t\t\t\t\tlet obj = {};\r\n\t\t\t\t\tfor (let v of style) {\r\n\t\t\t\t\t\tif (!v) continue;\r\n\t\t\t\t\t\tv = v.trim().split(':');\r\n\t\t\t\t\t\tif (v[1].indexOf('upx') >= 0) {\r\n\t\t\t\t\t\t\tlet arr = v[1].trim().split(' ');\r\n\t\t\t\t\t\t\tfor (let k in arr) {\r\n\t\t\t\t\t\t\t\tif (!arr[k]) continue;\r\n\t\t\t\t\t\t\t\tif (arr[k].indexOf('upx') >= 0) {\r\n\t\t\t\t\t\t\t\t\tarr[k] = parseFloat(arr[k]) * this.pxRatio + 'px';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tv[1] = arr.join(' ');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tobj[v[0].trim()] = v[1].trim();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.imgStyle = obj;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.expWidth && (this.exportWidth = this.expWidth.indexOf('upx') >= 0 ? parseInt(this.expWidth) * this.pxRatio :\r\n\t\t\t\t\tparseInt(this.expWidth));\r\n\t\t\t\tthis.expHeight && (this.exportHeight = this.expHeight.indexOf('upx') >= 0 ? parseInt(this.expHeight) * this.pxRatio :\r\n\t\t\t\t\tparseInt(this.expHeight));\r\n\r\n\t\t\t\tif (this.styleDisplay === 'flex') {\r\n\t\t\t\t\tthis.fDrawInit(true);\r\n\t\t\t\t}\r\n\t\t\t\tthis.fHideImg();\r\n\t\t\t},\r\n\t\t\tfSelect() {\r\n\t\t\t\tif (this.fSelecting) return;\r\n\t\t\t\tthis.fSelecting = true;\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.fSelecting = false;\r\n\t\t\t\t}, 500);\r\n\r\n\t\t\t\tuni.chooseImage({\r\n\t\t\t\t\tcount: 1,\r\n\t\t\t\t\tsizeType: ['original', 'compressed'],\r\n\t\t\t\t\tsourceType: ['album', 'camera'],\r\n\t\t\t\t\tsuccess: (r) => {\r\n\t\t\t\t\t\t// #ifdef MP-ALIPAY\r\n\t\t\t\t\t\tuni.showLoading();\r\n\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t\t// #ifndef MP-ALIPAY\r\n\t\t\t\t\t\tuni.showLoading({\r\n\t\t\t\t\t\t\ttitle: '加载中...',\r\n\t\t\t\t\t\t\tmask: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t// #endif\r\n\r\n\t\t\t\t\t\tlet path = this.imgPath = r.tempFilePaths[0];\r\n\t\t\t\t\t\tuni.getImageInfo({\r\n\t\t\t\t\t\t\tsrc: path,\r\n\t\t\t\t\t\t\tsuccess: r => {\r\n\t\t\t\t\t\t\t\tthis.imgWidth = r.width;\r\n\t\t\t\t\t\t\t\tthis.imgHeight = r.height;\r\n\t\t\t\t\t\t\t\tthis.path = path;\r\n\t\t\t\t\t\t\t\tif (!this.hasSel) {\r\n\t\t\t\t\t\t\t\t\tlet style = this.selStyle || {};\r\n\t\t\t\t\t\t\t\t\tif (this.selWidth && this.selHeight) {\r\n\t\t\t\t\t\t\t\t\t\tlet selWidth = this.selWidth.indexOf('upx') >= 0 ? parseInt(this.selWidth) * this.pxRatio : parseInt(\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.selWidth),\r\n\t\t\t\t\t\t\t\t\t\t\tselHeight = this.selHeight.indexOf('upx') >= 0 ? parseInt(this.selHeight) * this.pxRatio : parseInt(\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.selHeight);\r\n\t\t\t\t\t\t\t\t\t\tstyle.width = selWidth + 'px';\r\n\t\t\t\t\t\t\t\t\t\tstyle.height = selHeight + 'px';\r\n\t\t\t\t\t\t\t\t\t\tstyle.top = ((this.windowHeight - selHeight - tabHeight)|0) / 2 + 'px';\r\n\t\t\t\t\t\t\t\t\t\tstyle.left = ((this.windowWidth - selWidth)|0) / 2 + 'px';\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\t\t\t\ttitle: '裁剪框的宽或高没有设置',\r\n\t\t\t\t\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tthis.selStyle = style;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif (this.noBar) {\r\n\t\t\t\t\t\t\t\t\tthis.fDrawInit(true);\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tuni.hideTabBar({\r\n\t\t\t\t\t\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\t\t\t\t\t\tthis.fDrawInit(true);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tfail: () => {\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: \"请选择正确图片\",\r\n\t\t\t\t\t\t\t\t\tduration: 2000,\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tcomplete() {\r\n\t\t\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tfUpload() {\r\n\t\t\t\tif (this.fUploading) return;\r\n\t\t\t\tthis.fUploading = true;\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.fUploading = false;\r\n\t\t\t\t}, 1000)\r\n\r\n\t\t\t\tlet style = this.selStyle,\r\n\t\t\t\t\tx = parseInt(style.left),\r\n\t\t\t\t\ty = parseInt(style.top),\r\n\t\t\t\t\twidth = parseInt(style.width),\r\n\t\t\t\t\theight = parseInt(style.height),\r\n\t\t\t\t\texpWidth = (this.exportWidth || width) * this.pixelRatio,\r\n\t\t\t\t\texpHeight = (this.exportHeight || height) * this.pixelRatio;\r\n\r\n\t\t\t\t// #ifdef MP-ALIPAY\r\n\t\t\t\tuni.showLoading();\r\n\t\t\t\t// #endif\r\n\t\t\t\t// #ifndef MP-ALIPAY\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '加载中...',\r\n\t\t\t\t\tmask: true\r\n\t\t\t\t});\r\n\t\t\t\t// #endif\r\n\r\n\t\t\t\tthis.styleDisplay = 'none';\r\n\t\t\t\tthis.styleTop = '-10000px';\r\n\t\t\t\tthis.hasSel = false;\r\n\t\t\t\tthis.fHideImg();\r\n\t\t\t\t// #ifdef MP-ALIPAY\r\n\t\t\t\tthis.ctxCanvas.toTempFilePath({\r\n\t\t\t\t\tx: x,\r\n\t\t\t\t\ty: y,\r\n\t\t\t\t\twidth: width,\r\n\t\t\t\t\theight: height,\r\n\t\t\t\t\tdestWidth: expWidth,\r\n\t\t\t\t\tdestHeight: expHeight,\r\n\t\t\t\t\tfileType: this.fType,\r\n\t\t\t\t\tquality: this.qlty,\r\n\t\t\t\t\tsuccess: (r) => {\r\n\t\t\t\t\t\tr = r.apFilePath;\r\n\t\t\t\t\t\tthis.$emit(\"upload\", {\r\n\t\t\t\t\t\t\tavatar: this.imgSrc,\r\n\t\t\t\t\t\t\tpath: r,\r\n\t\t\t\t\t\t\tindex: this.indx,\r\n\t\t\t\t\t\t\tdata: this.rtn,\r\n\t\t\t\t\t\t\tbase64: this.base64 || null\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (res) => {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: \"error1\",\r\n\t\t\t\t\t\t\tduration: 2000,\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\tthis.noBar || uni.showTabBar();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t// #endif\r\n\t\t\t\t// #ifndef MP-ALIPAY\r\n\t\t\t\tuni.canvasToTempFilePath({\r\n\t\t\t\t\tx: x,\r\n\t\t\t\t\ty: y,\r\n\t\t\t\t\twidth: width,\r\n\t\t\t\t\theight: height,\r\n\t\t\t\t\tdestWidth: expWidth,\r\n\t\t\t\t\tdestHeight: expHeight,\r\n\t\t\t\t\tcanvasId: 'avatar-canvas',\r\n\t\t\t\t\tfileType: this.fType,\r\n\t\t\t\t\tquality: this.qlty,\r\n\t\t\t\t\tsuccess: (r) => {\r\n\t\t\t\t\t\tr = r.tempFilePath;\r\n\t\t\t\t\t\t// #ifdef H5\r\n\t\t\t\t\t\tthis.btop(r).then((r) => {\r\n\t\t\t\t\t\t\tif (this.exportWidth && this.exportHeight) {\r\n\t\t\t\t\t\t\t\tlet ctxCanvas = this.ctxCanvas,\r\n\t\t\t\t\t\t\t\t\texpWidth = this.exportWidth;\r\n\t\t\t\t\t\t\t\texpHeight = this.exportHeight;\r\n\r\n\t\t\t\t\t\t\t\tctxCanvas.drawImage(r, 0, 0, expWidth, expHeight);\r\n\t\t\t\t\t\t\t\tctxCanvas.draw(false, () => {\r\n\t\t\t\t\t\t\t\t\tuni.canvasToTempFilePath({\r\n\t\t\t\t\t\t\t\t\t\tx: 0,\r\n\t\t\t\t\t\t\t\t\t\ty: 0,\r\n\t\t\t\t\t\t\t\t\t\twidth: expWidth,\r\n\t\t\t\t\t\t\t\t\t\theight: expHeight,\r\n\t\t\t\t\t\t\t\t\t\tdestWidth: expWidth * this.pixelRatio,\r\n\t\t\t\t\t\t\t\t\t\tdestHeight: expHeight * this.pixelRatio,\r\n\t\t\t\t\t\t\t\t\t\tcanvasId: 'avatar-canvas',\r\n\t\t\t\t\t\t\t\t\t\tfileType: this.fType,\r\n\t\t\t\t\t\t\t\t\t\tquality: this.qlty,\r\n\t\t\t\t\t\t\t\t\t\tsuccess: (r) => {\r\n\t\t\t\t\t\t\t\t\t\t\tr = r.tempFilePath;\r\n\t\t\t\t\t\t\t\t\t\t\tthis.btop(r).then((r) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.$emit(\"upload\", {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tavatar: this.imgSrc,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpath: r,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tindex: this.indx,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdata: this.rtn,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbase64: this.base64 || null\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tfail: () => {\r\n\t\t\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: \"error0\",\r\n\t\t\t\t\t\t\t\t\t\t\t\tduration: 2000,\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.$emit(\"upload\", {\r\n\t\t\t\t\t\t\t\t\tavatar: this.imgSrc,\r\n\t\t\t\t\t\t\t\t\tpath: r,\r\n\t\t\t\t\t\t\t\t\tindex: this.indx,\r\n\t\t\t\t\t\t\t\t\tdata: this.rtn,\r\n\t\t\t\t\t\t\t\t\tbase64: this.base64 || null\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t\t// #ifndef H5\r\n\t\t\t\t\t\tthis.$emit(\"upload\", {\r\n\t\t\t\t\t\t\tavatar: this.imgSrc,\r\n\t\t\t\t\t\t\tpath: r,\r\n\t\t\t\t\t\t\tindex: this.indx,\r\n\t\t\t\t\t\t\tdata: this.rtn,\r\n\t\t\t\t\t\t\tbase64: this.base64 || null\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (res) => {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: \"error1\",\r\n\t\t\t\t\t\t\tduration: 2000,\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\tthis.noBar || uni.showTabBar();\r\n\t\t\t\t\t}\r\n\t\t\t\t}, this);\r\n\t\t\t\t// #endif\r\n\t\t\t},\r\n\t\t\tfPrvUpload() {\r\n\t\t\t\tif (this.fPrvUploading) return;\r\n\t\t\t\tthis.fPrvUploading = true;\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.fPrvUploading = false;\r\n\t\t\t\t}, 1000)\r\n\r\n\t\t\t\tlet style = this.selStyle,\r\n\t\t\t\t\tdestWidth = parseInt(style.width),\r\n\t\t\t\t\tdestHeight = parseInt(style.height),\r\n\t\t\t\t\tprvX = this.prvX,\r\n\t\t\t\t\tprvY = this.prvY,\r\n\t\t\t\t\tprvWidth = this.prvWidth,\r\n\t\t\t\t\tprvHeight = this.prvHeight,\r\n\t\t\t\t\texpWidth = (this.exportWidth || prvWidth) * this.pixelRatio,\r\n\t\t\t\t\texpHeight = (this.exportHeight || prvHeight) * this.pixelRatio;\r\n\r\n\t\t\t\t// #ifdef MP-ALIPAY\r\n\t\t\t\tuni.showLoading();\r\n\t\t\t\t// #endif\r\n\t\t\t\t// #ifndef MP-ALIPAY\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '加载中...',\r\n\t\t\t\t\tmask: true\r\n\t\t\t\t});\r\n\t\t\t\t// #endif\r\n\r\n\t\t\t\tthis.styleDisplay = 'none';\r\n\t\t\t\tthis.styleTop = '-10000px';\r\n\t\t\t\tthis.hasSel = false;\r\n\t\t\t\tthis.fHideImg();\r\n\t\t\t\t// #ifdef MP-ALIPAY\r\n\t\t\t\tthis.ctxCanvasPrv.toTempFilePath({\r\n\t\t\t\t\tx: prvX,\r\n\t\t\t\t\ty: prvY,\r\n\t\t\t\t\twidth: prvWidth,\r\n\t\t\t\t\theight: prvHeight,\r\n\t\t\t\t\tdestWidth: expWidth,\r\n\t\t\t\t\tdestHeight: expHeight,\r\n\t\t\t\t\tfileType: this.fType,\r\n\t\t\t\t\tquality: this.qlty,\r\n\t\t\t\t\tsuccess: (r) => {\r\n\t\t\t\t\t\tr = r.apFilePath;\r\n\t\t\t\t\t\tthis.$emit(\"upload\", {\r\n\t\t\t\t\t\t\tavatar: this.imgSrc,\r\n\t\t\t\t\t\t\tpath: r,\r\n\t\t\t\t\t\t\tindex: this.indx,\r\n\t\t\t\t\t\t\tdata: this.rtn,\r\n\t\t\t\t\t\t\tbase64: this.base64 || null\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: () => {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: \"error_prv\",\r\n\t\t\t\t\t\t\tduration: 2000,\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\tthis.noBar || uni.showTabBar();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t// #endif\r\n\t\t\t\t// #ifndef MP-ALIPAY\r\n\t\t\t\tuni.canvasToTempFilePath({\r\n\t\t\t\t\tx: prvX,\r\n\t\t\t\t\ty: prvY,\r\n\t\t\t\t\twidth: prvWidth,\r\n\t\t\t\t\theight: prvHeight,\r\n\t\t\t\t\tdestWidth: expWidth,\r\n\t\t\t\t\tdestHeight: expHeight,\r\n\t\t\t\t\tcanvasId: 'prv-canvas',\r\n\t\t\t\t\tfileType: this.fType,\r\n\t\t\t\t\tquality: this.qlty,\r\n\t\t\t\t\tsuccess: (r) => {\r\n\t\t\t\t\t\tr = r.tempFilePath;\r\n\t\t\t\t\t\t// #ifdef H5\r\n\t\t\t\t\t\tthis.btop(r).then((r) => {\r\n\t\t\t\t\t\t\tif (this.exportWidth && this.exportHeight) {\r\n\t\t\t\t\t\t\t\tlet ctxCanvas = this.ctxCanvas;\r\n\t\t\t\t\t\t\t\texpWidth = this.exportWidth,\r\n\t\t\t\t\t\t\t\t\texpHeight = this.exportHeight;\r\n\r\n\t\t\t\t\t\t\t\tctxCanvas.drawImage(r, 0, 0, expWidth, expHeight);\r\n\t\t\t\t\t\t\t\tctxCanvas.draw(false, () => {\r\n\t\t\t\t\t\t\t\t\tuni.canvasToTempFilePath({\r\n\t\t\t\t\t\t\t\t\t\tx: 0,\r\n\t\t\t\t\t\t\t\t\t\ty: 0,\r\n\t\t\t\t\t\t\t\t\t\twidth: expWidth,\r\n\t\t\t\t\t\t\t\t\t\theight: expHeight,\r\n\t\t\t\t\t\t\t\t\t\tdestWidth: expWidth * this.pixelRatio,\r\n\t\t\t\t\t\t\t\t\t\tdestHeight: expHeight * this.pixelRatio,\r\n\t\t\t\t\t\t\t\t\t\tcanvasId: 'avatar-canvas',\r\n\t\t\t\t\t\t\t\t\t\tfileType: this.fType,\r\n\t\t\t\t\t\t\t\t\t\tquality: this.qlty,\r\n\t\t\t\t\t\t\t\t\t\tsuccess: (r) => {\r\n\t\t\t\t\t\t\t\t\t\t\tr = r.tempFilePath;\r\n\t\t\t\t\t\t\t\t\t\t\tthis.btop(r).then((r) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.$emit(\"upload\", {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tavatar: this.imgSrc,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpath: r,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tindex: this.indx,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdata: this.rtn,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbase64: this.base64 || null\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tfail: () => {\r\n\t\t\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: \"error0\",\r\n\t\t\t\t\t\t\t\t\t\t\t\tduration: 2000,\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.$emit(\"upload\", {\r\n\t\t\t\t\t\t\t\t\tavatar: this.imgSrc,\r\n\t\t\t\t\t\t\t\t\tpath: r,\r\n\t\t\t\t\t\t\t\t\tindex: this.indx,\r\n\t\t\t\t\t\t\t\t\tdata: this.rtn,\r\n\t\t\t\t\t\t\t\t\tbase64: this.base64 || null\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t\t// #ifndef H5\r\n\t\t\t\t\t\tthis.$emit(\"upload\", {\r\n\t\t\t\t\t\t\tavatar: this.imgSrc,\r\n\t\t\t\t\t\t\tpath: r,\r\n\t\t\t\t\t\t\tindex: this.indx,\r\n\t\t\t\t\t\t\tdata: this.rtn,\r\n\t\t\t\t\t\t\tbase64: this.base64 || null\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: () => {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: \"error_prv\",\r\n\t\t\t\t\t\t\tduration: 2000,\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\tthis.noBar || uni.showTabBar();\r\n\t\t\t\t\t}\r\n\t\t\t\t}, this);\r\n\t\t\t\t// #endif\r\n\t\t\t},\r\n\t\t\tfDrawInit(ini = false) {\r\n\t\t\t\tlet allWidth = this.windowWidth,\r\n\t\t\t\t\tallHeight = this.windowHeight,\r\n\t\t\t\t\timgWidth = this.imgWidth,\r\n\t\t\t\t\timgHeight = this.imgHeight,\r\n\t\t\t\t\timgRadio = imgWidth / imgHeight,\r\n\t\t\t\t\tuseWidth = allWidth - 40,\r\n\t\t\t\t\tuseHeight = allHeight - tabHeight - 80,\r\n\t\t\t\t\tuseRadio = useWidth / useHeight,\r\n\t\t\t\t\tselWidth = parseInt(this.selStyle.width),\r\n\t\t\t\t\tselHeight = parseInt(this.selStyle.height);\r\n\r\n\t\t\t\tthis.fixWidth = 0;\r\n\t\t\t\tthis.fixHeight = 0;\r\n\t\t\t\tthis.lckWidth = 0;\r\n\t\t\t\tthis.lckHeight = 0;\r\n\t\t\t\tswitch (this.stc) {\r\n\t\t\t\t\tcase 'x':\r\n\t\t\t\t\t\tthis.fixWidth = 1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'y':\r\n\t\t\t\t\t\tthis.fixHeight = 1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'long':\r\n\t\t\t\t\t\tif (imgRadio > 1) this.fixWidth = 1;\r\n\t\t\t\t\t\telse this.fixHeight = 1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'short':\r\n\t\t\t\t\t\tif (imgRadio > 1) this.fixHeight = 1;\r\n\t\t\t\t\t\telse this.fixWidth = 1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'longSel':\r\n\t\t\t\t\t\tif (selWidth > selHeight) this.fixWidth = 1;\r\n\t\t\t\t\t\telse this.fixHeight = 1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'shortSel':\r\n\t\t\t\t\t\tif (selWidth > selHeight) this.fixHeight = 1;\r\n\t\t\t\t\t\telse this.fixWidth = 1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tswitch (this.lck) {\r\n\t\t\t\t\tcase 'x':\r\n\t\t\t\t\t\tthis.lckWidth = 1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'y':\r\n\t\t\t\t\t\tthis.lckHeight = 1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'long':\r\n\t\t\t\t\t\tif (imgRadio > 1) this.lckWidth = 1;\r\n\t\t\t\t\t\telse this.lckHeight = 1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'short':\r\n\t\t\t\t\t\tif (imgRadio > 1) this.lckHeight = 1;\r\n\t\t\t\t\t\telse this.lckWidth = 1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'longSel':\r\n\t\t\t\t\t\tif (selWidth > selHeight) this.lckWidth = 1;\r\n\t\t\t\t\t\telse this.lckHeight = 1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'shortSel':\r\n\t\t\t\t\t\tif (selWidth > selHeight) this.lckHeight = 1;\r\n\t\t\t\t\t\telse this.lckWidth = 1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.fixWidth) {\r\n\t\t\t\t\tuseWidth = selWidth;\r\n\t\t\t\t\tuseHeight = useWidth / imgRadio;\r\n\t\t\t\t} else if (this.fixHeight) {\r\n\t\t\t\t\tuseHeight = selHeight;\r\n\t\t\t\t\tuseWidth = useHeight * imgRadio;\r\n\t\t\t\t} else if (imgRadio < useRadio) {\r\n\t\t\t\t\tif (imgHeight < useHeight) {\r\n\t\t\t\t\t\tuseWidth = imgWidth;\r\n\t\t\t\t\t\tuseHeight = imgHeight;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// useHeight = useHeight;\r\n\t\t\t\t\t\tuseWidth = useHeight * imgRadio;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (imgWidth < useWidth) {\r\n\t\t\t\t\t\tuseWidth = imgWidth;\r\n\t\t\t\t\t\tuseHeight = imgHeight;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// useWidth = useWidth;\r\n\t\t\t\t\t\tuseHeight = useWidth / imgRadio;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (this.isin) {\r\n\t\t\t\t\tif (useWidth < selWidth) {\r\n\t\t\t\t\t\tuseWidth = selWidth;\r\n\t\t\t\t\t\tuseHeight = useWidth / imgRadio;\r\n\t\t\t\t\t\tthis.lckHeight = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (useHeight < selHeight) {\r\n\t\t\t\t\t\tuseHeight = selHeight;\r\n\t\t\t\t\t\tuseWidth = useHeight * imgRadio;\r\n\t\t\t\t\t\tthis.lckWidth = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.scaleSize = 1;\r\n\t\t\t\tthis.rotateDeg = 0;\r\n\t\t\t\tthis.posWidth = (allWidth - useWidth) / 2 | 0;\r\n\t\t\t\tthis.posHeight = (allHeight - useHeight - tabHeight) / 2 | 0;\r\n\t\t\t\tthis.useWidth = useWidth | 0;\r\n\t\t\t\tthis.useHeight = useHeight | 0;\r\n\t\t\t\tthis.centerX = this.posWidth + useWidth / 2;\r\n\t\t\t\tthis.centerY = this.posHeight + useHeight / 2;\r\n\t\t\t\tthis.focusX = 0;\r\n\t\t\t\tthis.focusY = 0;\r\n\r\n\t\t\t\tlet style = this.selStyle,\r\n\t\t\t\t\tleft = parseInt(style.left),\r\n\t\t\t\t\ttop = parseInt(style.top),\r\n\t\t\t\t\twidth = parseInt(style.width),\r\n\t\t\t\t\theight = parseInt(style.height),\r\n\t\t\t\t\tcanvas = this.canvas,\r\n\t\t\t\t\tcanvasOper = this.canvasOper,\r\n\t\t\t\t\tctxCanvas = this.ctxCanvas,\r\n\t\t\t\t\tctxCanvasOper = this.ctxCanvasOper;\r\n\r\n\t\t\t\tctxCanvasOper.setLineWidth(3);\r\n\t\t\t\tctxCanvasOper.setGlobalAlpha(1);\r\n\t\t\t\tctxCanvasOper.setStrokeStyle('white');\r\n\t\t\t\tctxCanvasOper.strokeRect(left, top, width, height);\r\n\t\t\t\t\r\n\t\t\t\tctxCanvasOper.setFillStyle('black');\r\n\t\t\t\tctxCanvasOper.setGlobalAlpha(0.5);\r\n\t\t\t\tctxCanvasOper.fillRect(0, 0, this.windowWidth, top);\r\n\t\t\t\tctxCanvasOper.fillRect(0, top, left, height);\r\n\t\t\t\tctxCanvasOper.fillRect(0, top + height, this.windowWidth, this.windowHeight - height - top - tabHeight);\r\n\t\t\t\tctxCanvasOper.fillRect(left + width, top, this.windowWidth - width - left, height);\r\n\t\t\t\t\r\n\t\t\t\tctxCanvasOper.setGlobalAlpha(1);\r\n\t\t\t\tctxCanvasOper.setStrokeStyle('red');\r\n\t\t\t\tctxCanvasOper.moveTo(left+15, top);\r\n\t\t\t\tctxCanvasOper.lineTo(left, top);\r\n\t\t\t\tctxCanvasOper.lineTo(left, top+15);\r\n\t\t\t\tctxCanvasOper.moveTo(left+width-15, top);\r\n\t\t\t\tctxCanvasOper.lineTo(left+width, top);\r\n\t\t\t\tctxCanvasOper.lineTo(left+width, top+15);\r\n\t\t\t\tctxCanvasOper.moveTo(left+15, top+height);\r\n\t\t\t\tctxCanvasOper.lineTo(left, top+height);\r\n\t\t\t\tctxCanvasOper.lineTo(left, top+height-15);\r\n\t\t\t\tctxCanvasOper.moveTo(left+width-15, top+height);\r\n\t\t\t\tctxCanvasOper.lineTo(left+width, top+height);\r\n\t\t\t\tctxCanvasOper.lineTo(left+width, top+height-15);\r\n\t\t\t\tctxCanvasOper.stroke();\r\n\r\n\t\t\t\tctxCanvasOper.draw(false, () => {\r\n\t\t\t\t\tif (ini) {\r\n\t\t\t\t\t\tthis.styleDisplay = 'flex';\r\n\t\t\t\t\t\t// #ifdef H5\r\n\t\t\t\t\t\tthis.styleTop = this.drawTop + 'px';\r\n\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t\t// #ifndef H5\r\n\t\t\t\t\t\tthis.styleTop = '0';\r\n\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t\tthis.fDrawImage(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.$emit(\"avtinit\");\r\n\t\t\t},\r\n\t\t\tfDrawImage(ini = false) {\r\n\t\t\t\tlet tm_now = Date.now();\r\n\t\t\t\tif (tm_now - this.drawTm < 20) return;\r\n\t\t\t\tthis.drawTm = tm_now;\r\n\r\n\t\t\t\tlet ctxCanvas = this.ctxCanvas,\r\n\t\t\t\t\timgWidth = this.useWidth * this.scaleSize,\r\n\t\t\t\t\timgHeight = this.useHeight * this.scaleSize;\r\n\r\n\t\t\t\t// #ifdef MP-ALIPAY\t\r\n\t\t\t\tctxCanvas.save();\r\n\t\t\t\t// #endif\r\n\r\n\t\t\t\tif (this.bgImage) {\r\n\t\t\t\t\t// #ifdef MP-ALIPAY\r\n\t\t\t\t\tctxCanvas.fillRect(0, 0, this.windowWidth, this.windowHeight - tabHeight);\r\n\t\t\t\t\t// #endif\r\n\t\t\t\t\t// #ifndef MP-ALIPAY\r\n\t\t\t\t\tctxCanvas.drawImage(this.bgImage, 0, 0, this.windowWidth, this.windowHeight - tabHeight);\r\n\t\t\t\t\t// #endif\r\n\t\t\t\t} else {\r\n\t\t\t\t\tctxCanvas.fillRect(0, 0, this.windowWidth, this.windowHeight - tabHeight);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.isin) {\r\n\t\t\t\t\tlet cx = this.focusX * (this.scaleSize - 1),\r\n\t\t\t\t\t\tcy = this.focusY * (this.scaleSize - 1);\r\n\r\n\t\t\t\t\tctxCanvas.translate(this.centerX, this.centerY);\r\n\t\t\t\t\tctxCanvas.rotate(this.rotateDeg * Math.PI / 180);\r\n\t\t\t\t\tctxCanvas.drawImage(this.imgPath, this.posWidth-this.centerX-cx, this.posHeight-this.centerY-cy, imgWidth, imgHeight);\r\n\t\t\t\t\r\n\t\t\t\t} else {\r\n\t\t\t\t\tctxCanvas.translate(this.posWidth + imgWidth / 2, this.posHeight + imgHeight / 2);\r\n\t\t\t\t\tctxCanvas.rotate(this.rotateDeg * Math.PI / 180);\r\n\t\t\t\t\tctxCanvas.drawImage(this.imgPath, -imgWidth / 2, -imgHeight / 2, imgWidth, imgHeight);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tctxCanvas.draw(false);\r\n\r\n\t\t\t\t// #ifdef MP-ALIPAY\r\n\t\t\t\tctxCanvas.restore();\r\n\t\t\t\t// #endif\r\n\t\t\t},\r\n\t\t\tfPreview() {\r\n\t\t\t\tif (this.fPreviewing) return;\r\n\t\t\t\tthis.fPreviewing = true;\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.fPreviewing = false;\r\n\t\t\t\t}, 1000);\r\n\r\n\t\t\t\tlet style = this.selStyle,\r\n\t\t\t\t\tx = parseInt(style.left),\r\n\t\t\t\t\ty = parseInt(style.top),\r\n\t\t\t\t\twidth = parseInt(style.width),\r\n\t\t\t\t\theight = parseInt(style.height);\r\n\r\n\t\t\t\t// #ifdef MP-ALIPAY\r\n\t\t\t\tuni.showLoading();\r\n\t\t\t\t// #endif\r\n\t\t\t\t// #ifndef MP-ALIPAY\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '加载中...',\r\n\t\t\t\t\tmask: true\r\n\t\t\t\t});\r\n\t\t\t\t// #endif\r\n\r\n\t\t\t\t// #ifdef MP-ALIPAY\r\n\t\t\t\tthis.ctxCanvas.toTempFilePath({\r\n\t\t\t\t\tx: x,\r\n\t\t\t\t\ty: y,\r\n\t\t\t\t\twidth: width,\r\n\t\t\t\t\theight: height,\r\n\t\t\t\t\texpWidth: width * this.pixelRatio,\r\n\t\t\t\t\texpHeight: height * this.pixelRatio,\r\n\t\t\t\t\tfileType: this.fType,\r\n\t\t\t\t\tquality: this.qlty,\r\n\t\t\t\t\tsuccess: (r) => {\r\n\t\t\t\t\t\tthis.prvImgTmp = r = r.apFilePath;\r\n\t\t\t\t\t\tlet ctxCanvasPrv = this.ctxCanvasPrv,\r\n\t\t\t\t\t\t\tprvX = this.windowWidth,\r\n\t\t\t\t\t\t\tprvY = parseInt(this.cvsStyleHeight),\r\n\t\t\t\t\t\t\tprvWidth = parseInt(this.selStyle.width),\r\n\t\t\t\t\t\t\tprvHeight = parseInt(this.selStyle.height),\r\n\t\t\t\t\t\t\tuseWidth = prvX - 40,\r\n\t\t\t\t\t\t\tuseHeight = prvY - 80,\r\n\t\t\t\t\t\t\tradio = useWidth / prvWidth,\r\n\t\t\t\t\t\t\trHeight = prvHeight * radio;\r\n\t\t\t\t\t\tif (rHeight < useHeight) {\r\n\t\t\t\t\t\t\tprvWidth = useWidth;\r\n\t\t\t\t\t\t\tprvHeight = rHeight;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tradio = useHeight / prvHeight;\r\n\t\t\t\t\t\t\tprvWidth *= radio;\r\n\t\t\t\t\t\t\tprvHeight = useHeight;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// ctxCanvasPrv.setFillStyle('black');\r\n\t\t\t\t\t\tctxCanvasPrv.fillRect(0, 0, prvX, prvY);\r\n\t\t\t\t\t\t// ctxCanvasPrv.drawImage(this.bgImage, 0, 0, prvX, prvY); 预览显示背景图\r\n\t\t\t\t\t\tthis.prvX = prvX = ((prvX - prvWidth) / 2) | 0;\r\n\t\t\t\t\t\tthis.prvY = prvY = ((prvY - prvHeight) / 2) | 0;\r\n\t\t\t\t\t\tthis.prvWidth = prvWidth = prvWidth | 0;\r\n\t\t\t\t\t\tthis.prvHeight = prvHeight = prvHeight | 0;\r\n\t\t\t\t\t\tctxCanvasPrv.drawImage(r, prvX, prvY, prvWidth, prvHeight);\r\n\t\t\t\t\t\tctxCanvasPrv.draw(false);\r\n\r\n\t\t\t\t\t\tthis.showOper = false;\r\n\t\t\t\t\t\tthis.prvTop = '0';\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: () => {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: \"error2\",\r\n\t\t\t\t\t\t\tduration: 2000,\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t// #endif\r\n\r\n\t\t\t\t// #ifndef MP-ALIPAY\r\n\t\t\t\tuni.canvasToTempFilePath({\r\n\t\t\t\t\tx: x,\r\n\t\t\t\t\ty: y,\r\n\t\t\t\t\twidth: width,\r\n\t\t\t\t\theight: height,\r\n\t\t\t\t\texpWidth: width * this.pixelRatio,\r\n\t\t\t\t\texpHeight: height * this.pixelRatio,\r\n\t\t\t\t\tcanvasId: 'avatar-canvas',\r\n\t\t\t\t\tfileType: this.fType,\r\n\t\t\t\t\tquality: this.qlty,\r\n\t\t\t\t\tsuccess: (r) => {\r\n\t\t\t\t\t\tthis.prvImgTmp = r = r.tempFilePath;\r\n\r\n\t\t\t\t\t\tlet ctxCanvasPrv = this.ctxCanvasPrv,\r\n\t\t\t\t\t\t\tprvX = this.windowWidth,\r\n\t\t\t\t\t\t\tprvY = parseInt(this.cvsStyleHeight);\r\n\r\n\t\t\t\t\t\t// #ifndef H5||MP-WEIXIN||APP-PLUS\r\n\t\t\t\t\t\tprvY += tabHeight;\r\n\t\t\t\t\t\t// #endif\r\n\t\t\t\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\t\t\tif (this.platform === 'android') {\r\n\t\t\t\t\t\t\tprvY += tabHeight;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// #endif\r\n\r\n\t\t\t\t\t\tlet prvWidth = parseInt(this.selStyle.width),\r\n\t\t\t\t\t\t\tprvHeight = parseInt(this.selStyle.height),\r\n\t\t\t\t\t\t\tuseWidth = prvX - 40,\r\n\t\t\t\t\t\t\tuseHeight = prvY - 80,\r\n\t\t\t\t\t\t\tradio = useWidth / prvWidth,\r\n\t\t\t\t\t\t\trHeight = prvHeight * radio;\r\n\t\t\t\t\t\tif (rHeight < useHeight) {\r\n\t\t\t\t\t\t\tprvWidth = useWidth;\r\n\t\t\t\t\t\t\tprvHeight = rHeight;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tradio = useHeight / prvHeight;\r\n\t\t\t\t\t\t\tprvWidth *= radio;\r\n\t\t\t\t\t\t\tprvHeight = useHeight;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// ctxCanvasPrv.setFillStyle('black');\r\n\t\t\t\t\t\tctxCanvasPrv.fillRect(0, 0, prvX, prvY);\r\n\t\t\t\t\t\t// ctxCanvasPrv.drawImage(this.bgImage, 0, 0, prvX, prvY); 预览显示背景图\r\n\t\t\t\t\t\tthis.prvX = prvX = ((prvX - prvWidth) / 2) | 0;\r\n\t\t\t\t\t\tthis.prvY = prvY = ((prvY - prvHeight) / 2) | 0;\r\n\t\t\t\t\t\tthis.prvWidth = prvWidth = prvWidth | 0;\r\n\t\t\t\t\t\tthis.prvHeight = prvHeight = prvHeight | 0;\r\n\t\t\t\t\t\tctxCanvasPrv.drawImage(r, prvX, prvY, prvWidth, prvHeight);\r\n\t\t\t\t\t\tctxCanvasPrv.draw(false);\r\n\r\n\t\t\t\t\t\t// #ifdef H5\r\n\t\t\t\t\t\tthis.btop(r).then((r) => {\r\n\t\t\t\t\t\t\tthis.showOper = false;\r\n\t\t\t\t\t\t\tthis.prvTop = this.drawTop + 'px';\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t// #endif\r\n\r\n\t\t\t\t\t\t// #ifdef MP-WEIXIN || MP-BAIDU\r\n\t\t\t\t\t\tthis.showOper = false;\r\n\t\t\t\t\t\tthis.prvTop = '0';\r\n\t\t\t\t\t\t// #endif\r\n\r\n\t\t\t\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\t\t\tif (this.platform === 'android') {\r\n\t\t\t\t\t\t\t// this.prvTop = tabHeight + 'px';\r\n\t\t\t\t\t\t\t// this.showOper = false;\r\n\t\t\t\t\t\t\tthis.prvTop = '0';\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.showOper = false;\r\n\t\t\t\t\t\t\tthis.prvTop = '0';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// #endif\r\n\r\n\t\t\t\t\t\t// #ifndef H5||MP-WEIXIN||MP-BAIDU||APP-PLUS\r\n\t\t\t\t\t\t// this.prvTop = tabHeight + 'px';\r\n\t\t\t\t\t\t// this.showOper = false;\r\n\t\t\t\t\t\tthis.prvTop = '0';\r\n\t\t\t\t\t\t// #endif\r\n\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: () => {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: \"error2\",\r\n\t\t\t\t\t\t\tduration: 2000,\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t}\r\n\t\t\t\t}, this);\r\n\t\t\t\t// #endif\r\n\t\t\t},\r\n\t\t\tfChooseImg(index = undefined, params = undefined, data = undefined) {\r\n\t\t\t\tif (params) {\r\n\t\t\t\t\tlet selWidth = params.selWidth,\r\n\t\t\t\t\t\tselHeight = params.selHeight,\r\n\t\t\t\t\t\texpWidth = params.expWidth,\r\n\t\t\t\t\t\texpHeight = params.expHeight,\r\n\t\t\t\t\t\tquality = params.quality,\r\n\t\t\t\t\t\tcanRotate = params.canRotate,\r\n\t\t\t\t\t\tcanScale = params.canScale,\r\n\t\t\t\t\t\tminScale = params.minScale,\r\n\t\t\t\t\t\tmaxScale = params.maxScale,\r\n\t\t\t\t\t\tstretch = params.stretch,\r\n\t\t\t\t\t\tfileType = params.fileType,\r\n\t\t\t\t\t\tinner = params.inner,\r\n\t\t\t\t\t\tlock = params.lock;\r\n\r\n\t\t\t\t\texpWidth && (this.exportWidth = expWidth.indexOf('upx') >= 0 ? parseInt(expWidth) * this.pxRatio : parseInt(\r\n\t\t\t\t\t\texpWidth));\r\n\t\t\t\t\texpHeight && (this.exportHeight = expHeight.indexOf('upx') >= 0 ? parseInt(expHeight) * this.pxRatio : parseInt(\r\n\t\t\t\t\t\texpHeight));\r\n\t\t\t\t\tthis.letRotate = (canRotate === 'false' || inner === 'true' || inner === true) ? 0 : 1;\r\n\t\t\t\t\tthis.letScale = canScale === 'false' ? 0 : 1;\r\n\t\t\t\t\tthis.qlty = parseInt(quality) || 0.9;\r\n\t\t\t\t\tthis.mnScale = minScale || 0.3;\r\n\t\t\t\t\tthis.mxScale = maxScale || 4;\r\n\t\t\t\t\tthis.stc = stretch;\r\n\t\t\t\t\tthis.isin = (inner === true || inner === 'true') ? 1 : 0;\r\n\t\t\t\t\tthis.fType = fileType === 'jpg' ? 'jpg' : 'png';\r\n\t\t\t\t\tthis.lck = lock;\r\n\t\t\t\t\tif (this.isin) {\r\n\t\t\t\t\t\tthis.btnWidth = '24%';\r\n\t\t\t\t\t\tthis.btnDsp = 'none';\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.btnWidth = '19%';\r\n\t\t\t\t\t\tthis.btnDsp = 'flex';\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (selWidth && selHeight) {\r\n\t\t\t\t\t\tselWidth = selWidth.indexOf('upx') >= 0 ? parseInt(selWidth) * this.pxRatio : parseInt(selWidth);\r\n\t\t\t\t\t\tselHeight = selHeight.indexOf('upx') >= 0 ? parseInt(selHeight) * this.pxRatio : parseInt(selHeight);\r\n\t\t\t\t\t\tthis.selStyle.width = selWidth + 'px';\r\n\t\t\t\t\t\tthis.selStyle.height = selHeight + 'px';\r\n\t\t\t\t\t\tthis.selStyle.top = ((this.windowHeight - selHeight - tabHeight)|0) / 2 + 'px';\r\n\t\t\t\t\t\tthis.selStyle.left = ((this.windowWidth - selWidth)|0) / 2 + 'px';\r\n\t\t\t\t\t\tthis.hasSel = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.rtn = data;\r\n\t\t\t\tthis.indx = index;\r\n\t\t\t\tthis.fSelect();\r\n\t\t\t},\r\n\t\t\tfRotate() {\r\n\t\t\t\tthis.rotateDeg += 90 - this.rotateDeg % 90;\r\n\t\t\t\tthis.fDrawImage();\r\n\t\t\t},\r\n\t\t\tfStart(e) {\r\n\t\t\t\tlet touches = e.touches,\r\n\t\t\t\t\ttouch0 = touches[0],\r\n\t\t\t\t\ttouch1 = touches[1];\r\n\r\n\t\t\t\tthis.touch0 = touch0;\r\n\t\t\t\tthis.touch1 = touch1;\r\n\r\n\t\t\t\tif (touch1) {\r\n\t\t\t\t\tlet x = touch1.x - touch0.x,\r\n\t\t\t\t\t\ty = touch1.y - touch0.y;\r\n\t\t\t\t\tthis.fgDistance = Math.sqrt(x * x + y * y);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tfMove(e) {\r\n\t\t\t\tlet touches = e.touches,\r\n\t\t\t\t\ttouch0 = touches[0],\r\n\t\t\t\t\ttouch1 = touches[1];\r\n\r\n\t\t\t\tif (touch1) {\r\n\t\t\t\t\tlet x = touch1.x - touch0.x,\r\n\t\t\t\t\t\ty = touch1.y - touch0.y,\r\n\t\t\t\t\t\tfgDistance = Math.sqrt(x * x + y * y),\r\n\t\t\t\t\t\tscaleSize = 0.005 * (fgDistance - this.fgDistance),\r\n\t\t\t\t\t\tbeScaleSize = this.scaleSize + scaleSize;\r\n\r\n\t\t\t\t\tdo {\r\n\t\t\t\t\t\tif (!this.letScale) break;\r\n\t\t\t\t\t\tif (beScaleSize < this.mnScale) break;\r\n\t\t\t\t\t\tif (beScaleSize > this.mxScale) break;\r\n\r\n\t\t\t\t\t\tlet growX = this.useWidth * scaleSize / 2,\r\n\t\t\t\t\t\t\tgrowY = this.useHeight * scaleSize / 2;\r\n\t\t\t\t\t\tif (this.isin) {\r\n\t\t\t\t\t\t\tlet imgWidth = this.useWidth * beScaleSize,\r\n\t\t\t\t\t\t\t\timgHeight = this.useHeight * beScaleSize,\r\n\t\t\t\t\t\t\t\tl = this.posWidth - growX,\r\n\t\t\t\t\t\t\t\tt = this.posHeight - growY,\r\n\t\t\t\t\t\t\t\tr = l + imgWidth,\r\n\t\t\t\t\t\t\t\tb = t + imgHeight,\r\n\t\t\t\t\t\t\t\tleft = parseInt(this.selStyle.left),\r\n\t\t\t\t\t\t\t\ttop = parseInt(this.selStyle.top),\r\n\t\t\t\t\t\t\t\twidth = parseInt(this.selStyle.width),\r\n\t\t\t\t\t\t\t\theight = parseInt(this.selStyle.height),\r\n\t\t\t\t\t\t\t\tright = left + width,\r\n\t\t\t\t\t\t\t\tbottom = top + height,\r\n\t\t\t\t\t\t\t\tcx, cy;\r\n\r\n\t\t\t\t\t\t\tif (imgWidth <= width || imgHeight <= height) break;\r\n\t\t\t\t\t\t\tthis.cx = cx = this.focusX * beScaleSize - this.focusX,\r\n\t\t\t\t\t\t\t\tthis.cy = cy = this.focusY * beScaleSize - this.focusY;\r\n\t\t\t\t\t\t\tthis.posWidth -= growX;\r\n\t\t\t\t\t\t\tthis.posHeight -= growY;\r\n\t\t\t\t\t\t\tif (this.posWidth - cx > left) {\r\n\t\t\t\t\t\t\t\tthis.posWidth = left + cx;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (this.posWidth + imgWidth - cx < right) {\r\n\t\t\t\t\t\t\t\tthis.posWidth = right - imgWidth + cx;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (this.posHeight - cy > top) {\r\n\t\t\t\t\t\t\t\tthis.posHeight = top + cy;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (this.posHeight + imgHeight - cy < bottom) {\r\n\t\t\t\t\t\t\t\tthis.posHeight = bottom - imgHeight + cy;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.posWidth -= growX;\r\n\t\t\t\t\t\t\tthis.posHeight -= growY;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis.scaleSize = beScaleSize;\r\n\t\t\t\t\t} while (0);\r\n\t\t\t\t\tthis.fgDistance = fgDistance;\r\n\t\t\t\t\tif (touch1.x !== touch0.x && this.letRotate) {\r\n\t\t\t\t\t\tx = (this.touch1.y - this.touch0.y) / (this.touch1.x - this.touch0.x);\r\n\t\t\t\t\t\ty = (touch1.y - touch0.y) / (touch1.x - touch0.x);\r\n\t\t\t\t\t\tthis.rotateDeg += Math.atan((y - x) / (1 + x * y)) * 180 / Math.PI;\r\n\t\t\t\t\t\tthis.touch0 = touch0;\r\n\t\t\t\t\t\tthis.touch1 = touch1;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.fDrawImage();\r\n\t\t\t\t} else if (this.touch0) {\r\n\t\t\t\t\tlet x = touch0.x - this.touch0.x,\r\n\t\t\t\t\t\ty = touch0.y - this.touch0.y,\r\n\t\t\t\t\t\tbeX = this.posWidth + x,\r\n\t\t\t\t\t\tbeY = this.posHeight + y;\r\n\t\t\t\t\tif (this.isin) {\r\n\t\t\t\t\t\tlet imgWidth = this.useWidth * this.scaleSize,\r\n\t\t\t\t\t\t\timgHeight = this.useHeight * this.scaleSize,\r\n\t\t\t\t\t\t\tl = beX,\r\n\t\t\t\t\t\t\tt = beY,\r\n\t\t\t\t\t\t\tr = l + imgWidth,\r\n\t\t\t\t\t\t\tb = t + imgHeight,\r\n\t\t\t\t\t\t\tleft = parseInt(this.selStyle.left),\r\n\t\t\t\t\t\t\ttop = parseInt(this.selStyle.top),\r\n\t\t\t\t\t\t\tright = left + parseInt(this.selStyle.width),\r\n\t\t\t\t\t\t\tbottom = top + parseInt(this.selStyle.height),\r\n\t\t\t\t\t\t\tcx, cy;\r\n\r\n\t\t\t\t\t\tthis.cx = cx = this.focusX * this.scaleSize - this.focusX;\r\n\t\t\t\t\t\tthis.cy = cy = this.focusY * this.scaleSize - this.focusY;\r\n\r\n\t\t\t\t\t\tif (!this.lckWidth && Math.abs(x) < 100) {\r\n\t\t\t\t\t\t\tif (left < l - cx) {\r\n\t\t\t\t\t\t\t\tthis.posWidth = left + cx;\r\n\t\t\t\t\t\t\t} else if (right > r - cx) {\r\n\t\t\t\t\t\t\t\tthis.posWidth = right - imgWidth + cx;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.posWidth = beX;\r\n\t\t\t\t\t\t\t\tthis.focusX -= x;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!this.lckHeight && Math.abs(y) < 100) {\r\n\t\t\t\t\t\t\tif (top < t - cy) {\r\n\t\t\t\t\t\t\t\tthis.focusY -= (top + cy - this.posHeight);\r\n\t\t\t\t\t\t\t\tthis.posHeight = top + cy;\r\n\t\t\t\t\t\t\t} else if (bottom > b - cy) {\r\n\t\t\t\t\t\t\t\tthis.focusY -= (bottom + cy - (this.posHeight + imgHeight));\r\n\t\t\t\t\t\t\t\tthis.posHeight = bottom - imgHeight + cy;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.posHeight = beY;\r\n\t\t\t\t\t\t\t\tthis.focusY -= y;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (Math.abs(x) < 100 && !this.lckWidth) this.posWidth = beX;\r\n\t\t\t\t\t\tif (Math.abs(y) < 100 && !this.lckHeight) this.posHeight = beY;\r\n\t\t\t\t\t\tthis.focusX -= x;\r\n\t\t\t\t\t\tthis.focusY -= y;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.touch0 = touch0;\r\n\t\t\t\t\tthis.fDrawImage();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tfEnd(e) {\r\n\t\t\t\tlet touches = e.touches,\r\n\t\t\t\t\ttouch0 = touches && touches[0],\r\n\t\t\t\t\ttouch1 = touches && touches[1];\r\n\t\t\t\tif (touch0) {\r\n\t\t\t\t\tthis.touch0 = touch0;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.touch0 = null;\r\n\t\t\t\t\tthis.touch1 = null;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tfHideImg() {\r\n\t\t\t\tthis.prvImg = '';\r\n\t\t\t\tthis.prvTop = '-10000px';\r\n\t\t\t\tthis.showOper = true;\r\n\t\t\t\tthis.prvImgData = null;\r\n\t\t\t\tthis.target = null;\r\n\t\t\t},\r\n\t\t\tfClose() {\r\n\t\t\t\tthis.styleDisplay = 'none';\r\n\t\t\t\tthis.styleTop = '-10000px';\r\n\t\t\t\tthis.hasSel = false;\r\n\t\t\t\tthis.fHideImg();\r\n\t\t\t\tthis.noBar || uni.showTabBar();\r\n\t\t\t},\r\n\t\t\tfGetImgData() {\r\n\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\tlet prvX = this.prvX,\r\n\t\t\t\t\t\tprvY = this.prvY,\r\n\t\t\t\t\t\tprvWidth = this.prvWidth,\r\n\t\t\t\t\t\tprvHeight = this.prvHeight;\r\n\t\t\t\t\t// #ifdef MP-ALIPAY\r\n\t\t\t\t\tthis.ctxCanvasPrv.getImageData({\r\n\t\t\t\t\t\tx: prvX,\r\n\t\t\t\t\t\ty: prvY,\r\n\t\t\t\t\t\twidth: prvWidth,\r\n\t\t\t\t\t\theight: prvHeight,\r\n\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\tresolve(res.data);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail(err) {\r\n\t\t\t\t\t\t\treject(err);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this);\r\n\t\t\t\t\t// #endif\r\n\t\t\t\t\t// #ifndef MP-ALIPAY\r\n\t\t\t\t\tuni.canvasGetImageData({\r\n\t\t\t\t\t\tcanvasId: 'prv-canvas',\r\n\t\t\t\t\t\tx: prvX,\r\n\t\t\t\t\t\ty: prvY,\r\n\t\t\t\t\t\twidth: prvWidth,\r\n\t\t\t\t\t\theight: prvHeight,\r\n\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\tresolve(res.data);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail(err) {\r\n\t\t\t\t\t\t\treject(err);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, this);\r\n\t\t\t\t\t// #endif\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tasync fColorChange(e) {\r\n\t\t\t\tlet tm_now = Date.now();\r\n\t\t\t\tif (tm_now - this.prvTm < 100) return;\r\n\t\t\t\tthis.prvTm = tm_now;\r\n\r\n\t\t\t\t// #ifdef MP-ALIPAY\r\n\t\t\t\tuni.showLoading();\r\n\t\t\t\t// #endif\r\n\t\t\t\t// #ifndef MP-ALIPAY\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '加载中...',\r\n\t\t\t\t\tmask: true\r\n\t\t\t\t});\r\n\t\t\t\t// #endif\r\n\r\n\t\t\t\tif (!this.prvImgData) {\r\n\t\t\t\t\tif (!(this.prvImgData = await this.fGetImgData().catch(() => {\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: \"error_read\",\r\n\t\t\t\t\t\t\t\tduration: 2000,\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}))) return;\r\n\r\n\t\t\t\t\tthis.target = new Uint8ClampedArray(this.prvImgData.length);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet data = this.prvImgData,\r\n\t\t\t\t\ttarget = this.target,\r\n\t\t\t\t\ti = e.detail.value,\r\n\t\t\t\t\tr, g, b, a, h, s, l, d, p, q, t, min, max, hK, tR, tG, tB;\r\n\r\n\t\t\t\tif (i === 0) {\r\n\t\t\t\t\ttarget = data;\r\n\t\t\t\t} else {\r\n\t\t\t\t\ti = (i + 100) / 200;\r\n\t\t\t\t\tif (i < 0.005) i = 0;\r\n\t\t\t\t\tif (i > 0.995) i = 1;\r\n\t\t\t\t\tfor (let n = data.length - 1; n >= 0; n -= 4) {\r\n\t\t\t\t\t\tr = data[n - 3] / 255;\r\n\t\t\t\t\t\tg = data[n - 2] / 255;\r\n\t\t\t\t\t\tb = data[n - 1] / 255;\r\n\t\t\t\t\t\tmax = Math.max(r, g, b);\r\n\t\t\t\t\t\tmin = Math.min(r, g, b);\r\n\t\t\t\t\t\td = max - min;\r\n\t\t\t\t\t\tif (max === min) {\r\n\t\t\t\t\t\t\th = 0;\r\n\t\t\t\t\t\t} else if (max === r && g >= b) {\r\n\t\t\t\t\t\t\th = 60 * ((g - b) / d);\r\n\t\t\t\t\t\t} else if (max === r && g < b) {\r\n\t\t\t\t\t\t\th = 60 * ((g - b) / d) + 360;\r\n\t\t\t\t\t\t} else if (max === g) {\r\n\t\t\t\t\t\t\th = 60 * ((b - r) / d) + 120;\r\n\t\t\t\t\t\t} else if (max === b) {\r\n\t\t\t\t\t\t\th = 60 * ((r - g) / d) + 240;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tl = (max + min) / 2;\r\n\t\t\t\t\t\tif (l === 0 || max === min) {\r\n\t\t\t\t\t\t\ts = 0;\r\n\t\t\t\t\t\t} else if (0 < l && l <= 0.5) {\r\n\t\t\t\t\t\t\ts = d / (2 * l);\r\n\t\t\t\t\t\t} else if (l > 0.5) {\r\n\t\t\t\t\t\t\ts = d / (2 - 2 * l);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdata[n] && (a = data[n]);\r\n\r\n\t\t\t\t\t\tif (i < 0.5) {\r\n\t\t\t\t\t\t\ts = s * i / 0.5;\r\n\t\t\t\t\t\t} else if (i > 0.5) {\r\n\t\t\t\t\t\t\ts = 2 * s + 2 * i - (s * i / 0.5) - 1;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (s === 0) {\r\n\t\t\t\t\t\t\tr = g = b = Math.round(l * 255);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (l < 0.5) {\r\n\t\t\t\t\t\t\t\tq = l * (1 + s);\r\n\t\t\t\t\t\t\t} else if (l >= 0.5) {\r\n\t\t\t\t\t\t\t\tq = l + s - (l * s);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tp = 2 * l - q;\r\n\t\t\t\t\t\t\thK = h / 360;\r\n\t\t\t\t\t\t\ttR = hK + 1 / 3;\r\n\t\t\t\t\t\t\ttG = hK;\r\n\t\t\t\t\t\t\ttB = hK - 1 / 3;\r\n\t\t\t\t\t\t\tlet correctRGB = (t) => {\r\n\t\t\t\t\t\t\t\tif (t < 0) {\r\n\t\t\t\t\t\t\t\t\treturn t + 1.0;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (t > 1) {\r\n\t\t\t\t\t\t\t\t\treturn t - 1.0;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn t;\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tlet createRGB = (t) => {\r\n\t\t\t\t\t\t\t\tif (t < (1 / 6)) {\r\n\t\t\t\t\t\t\t\t\treturn p + ((q - p) * 6 * t);\r\n\t\t\t\t\t\t\t\t} else if (t >= (1 / 6) && t < (1 / 2)) {\r\n\t\t\t\t\t\t\t\t\treturn q;\r\n\t\t\t\t\t\t\t\t} else if (t >= (1 / 2) && t < (2 / 3)) {\r\n\t\t\t\t\t\t\t\t\treturn p + ((q - p) * 6 * ((2 / 3) - t));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn p;\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tr = tR = Math.round(createRGB(correctRGB(tR)) * 255);\r\n\t\t\t\t\t\t\tg = tG = Math.round(createRGB(correctRGB(tG)) * 255);\r\n\t\t\t\t\t\t\tb = tB = Math.round(createRGB(correctRGB(tB)) * 255);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ta && (target[n] = a);\r\n\t\t\t\t\t\ttarget[n - 3] = r;\r\n\t\t\t\t\t\ttarget[n - 2] = g;\r\n\t\t\t\t\t\ttarget[n - 1] = b;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet prvX = this.prvX,\r\n\t\t\t\t\tprvY = this.prvY,\r\n\t\t\t\t\tprvWidth = this.prvWidth,\r\n\t\t\t\t\tprvHeight = this.prvHeight;\r\n\r\n\t\t\t\t// #ifdef MP-ALIPAY\r\n\t\t\t\tthis.ctxCanvasPrv.putImageData({\r\n\t\t\t\t\tx: prvX,\r\n\t\t\t\t\ty: prvY,\r\n\t\t\t\t\twidth: prvWidth,\r\n\t\t\t\t\theight: prvHeight,\r\n\t\t\t\t\tdata: target,\r\n\t\t\t\t\tfail() {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: 'error_put',\r\n\t\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete() {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t}\r\n\t\t\t\t}, this);\r\n\t\t\t\t// #endif\r\n\r\n\t\t\t\t// #ifndef MP-ALIPAY\r\n\t\t\t\tuni.canvasPutImageData({\r\n\t\t\t\t\tcanvasId: 'prv-canvas',\r\n\t\t\t\t\tx: prvX,\r\n\t\t\t\t\ty: prvY,\r\n\t\t\t\t\twidth: prvWidth,\r\n\t\t\t\t\theight: prvHeight,\r\n\t\t\t\t\tdata: target,\r\n\t\t\t\t\tfail() {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: 'error_put',\r\n\t\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete() {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t}\r\n\t\t\t\t}, this);\r\n\t\t\t\t// #endif\r\n\t\t\t},\r\n\t\t\tbtop(base64) {\r\n\t\t\t\tthis.base64 = base64;\r\n\t\t\t\treturn new Promise(function(resolve, reject) {\r\n\t\t\t\t\tvar arr = base64.split(','),\r\n\t\t\t\t\t\tmime = arr[0].match(/:(.*?);/)[1],\r\n\t\t\t\t\t\tbstr = atob(arr[1]),\r\n\t\t\t\t\t\tn = bstr.length,\r\n\t\t\t\t\t\tu8arr = new Uint8Array(n);\r\n\t\t\t\t\twhile (n--) {\r\n\t\t\t\t\t\tu8arr[n] = bstr.charCodeAt(n);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn resolve((window.URL || window.webkitURL).createObjectURL(new Blob([u8arr], {\r\n\t\t\t\t\t\ttype: mime\r\n\t\t\t\t\t})));\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.my-canvas {\r\n\t\tdisplay: flex;\r\n\t\tposition: fixed !important;\r\n\t\tbackground: #000000;\r\n\t\tleft: 0;\r\n\t\tz-index: 100000;\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t.my-avatar {\r\n\t\twidth: 150upx;\r\n\t\theight: 150upx;\r\n\t\tborder-radius: 100%;\r\n\t}\r\n\r\n\t.oper-canvas {\r\n\t\tdisplay: flex;\r\n\t\tposition: fixed !important;\r\n\t\tleft: 0;\r\n\t\tz-index: 100001;\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t.prv-canvas {\r\n\t\tdisplay: flex;\r\n\t\tposition: fixed !important;\r\n\t\tbackground: #000000;\r\n\t\tleft: 0;\r\n\t\tz-index: 200000;\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t.oper-wrapper {\r\n\t\theight: 50px;\r\n\t\tposition: fixed !important;\r\n\t\tbox-sizing: border-box;\r\n\t\tborder: 1px solid #F1F1F1;\r\n\t\tbackground: #ffffff;\r\n\t\twidth: 100%;\r\n\t\tleft: 0;\r\n\t\tbottom: 0;\r\n\t\tz-index: 100009;\r\n\t\tflex-direction: row;\r\n\t}\r\n\r\n\t.oper {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tjustify-content: center;\r\n\t\tpadding: 10upx 20upx;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tbox-sizing: border-box;\r\n\t\talign-self: center;\r\n\t}\r\n\r\n\t.btn-wrapper {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\t\t/* #ifndef H5 */\r\n\t\tflex-grow: 1;\r\n\t\t/* #endif */\r\n\t\t/* #ifdef H5 */\r\n\t\theight: 50px;\r\n\t\t/* #endif */\r\n\t\tjustify-content: space-between;\r\n\t}\r\n\r\n\t.btn-wrapper view {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tfont-size: 16px;\r\n\t\tcolor: #333;\r\n\t\tborder: 1px solid #f1f1f1;\r\n\t\tborder-radius: 6%;\r\n\t}\r\n\r\n\t.hover {\r\n\t\tbackground: #f1f1f1;\r\n\t\tborder-radius: 6%;\r\n\t}\r\n\r\n\t.clr-wrapper {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: row;\r\n\t\tflex-grow: 1;\r\n\t}\r\n\r\n\t.clr-wrapper view {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tfont-size: 16px;\r\n\t\tcolor: #333;\r\n\t\tborder: 1px solid #f1f1f1;\r\n\t\tborder-radius: 6%;\r\n\t}\r\n\r\n\t.my-slider {\r\n\t\tflex-grow: 1;\r\n\t}\r\n</style>\r\n","import mod from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./yq-avatar.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./yq-avatar.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1592703922832\n      var cssReload = require(\"D:/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}